// Generated by CoffeeScript 1.8.0
(function() {
  var collapseElement, collapseRecords, findAction;

  $(function() {
    collapseRecords($(this));
    $(".list-element-top-block").click(function() {
      return $(this).parent(this).find(".list-actions-menu").toggleClass("hidden");
    });
    $(".show-same-user-vids").click(function() {
      $(".same-user-list-element").toggleClass("hide-list-element");
      return $(".same-user-videos-navigation").toggleClass("hide-list-element");
    });
    return $('.set-yes-status, .set-no-status, .delete-record').click(function() {
      var action, is_update, obj, thisObj, to_hide, to_update;
      obj = $(this).closest(".list-actions-menu").attr("id");
      thisObj = $(this);
      to_update = $(this).closest(".list-group-item").find(".list-element-top-block").find(".video-status");
      is_update = $(this).hasClass("set-yes-status");
      to_hide = $(this).closest(".list-actions-menu");
      action = findAction($(this));
      return $.ajax({
        type: "POST",
        url: "/update",
        dataType: 'json',
        success: function(response) {
          console.log(response.html);
          to_update.html('UPDATED');
          return to_hide.toggleClass("hidden");
        },
        error: function(response) {},
        data: {
          name: obj,
          is_update: +is_update,
          action: action
        }
      });
    });
  });

  findAction = function(obj) {
    if (obj.hasClass('delete-record')) {
      return "delete";
    }
    return 0;
  };

  collapseRecords = function(obj) {
    var data_list;
    data_list = obj.find('.list-group').children('.userRecord').toArray().forEach(collapseElement);
    return console.log(data_list);
  };

  collapseElement = function(element, index, array) {
    var is_from;
    if (index > 0 && $(element).attr('data-user') === $(array[index - 1]).attr('data-user')) {
      if (!!$(array[index - 1]).attr('is-main') && !!!$(array[index - 1]).attr('not-main')) {
        $(array[index - 1]).attr('data-contain-hidden', parseInt($(array[index - 1]).attr('data-contain-hidden')) + 1);
        return $(element).attr('not-main', '1').attr('is-from', index - 1);
      } else if (!!$(array[index - 1]).attr('not-main')) {
        is_from = parseInt($(array[index - 1]).attr('is-from'));
        $(element).attr('not-main', '1').attr('is-from', is_from);
        return $(array[is_from]).attr('data-contain-hidden', parseInt($(array[is_from]).attr('data-contain-hidden')) + 1);
      }
    } else {
      $(element).attr('is-main', '1');
      return $(element).attr('data-contain-hidden', '0');
    }
  };

}).call(this);

//# sourceMappingURL=main.js.map
